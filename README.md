# java-convenience-store-precourse

## 미션 소개

이 프로젝트는 우아한테크코스 프리코스 4주차 미션으로, 편의점을 구현한다.

## 미션 목표

### 기본 요구사항

- indent의 depth를 3이 넘지 않도록 구현한다.
- 메서드가 한 가지 일만 하도록 최대한 작게 만든다.
- 3항 연산자를 쓰지 않는다.
- 메서드의 길이가 10 라인을 넘어가지 않도록 구현한다.
- else 예약어를 쓰지 않는다.
- Enum을 적용하여 구현한다.

### 개인적 목표에 따른 요구사항

- 객체 지향 프로그래밍 원칙을 적용한 편의점을 구현한다.
- 기능별 커밋을 원칙으로 한다.
- TDD를 적용한다.
    - 각 기능별로 테스트 케이스를 작성한다.
    - 기능별로 해피 케이스, 예외 케이스를 나누어 작성한다.
    - 실패 테스트 작성 -> 테스트 통과 -> 리팩토링
- 클린 코드를 지향하며 의미 있는 변수명과 메서드명을 사용한다.

## 주요 클래스 설명

### 도메인 객체

- `Application`: 프로그램의 진입점이며 ConvenienceStoreManager를 초기화하고 실행
- `ConvenienceStoreManager`: 편의점 로직 총괄 관리
- `Product`: 상품 정보와 재고 관리
- `PrimitiveProductInfo`: 상품의 기본 정보(이름, 가격, 수량, 프로모션명) 저장
- `Promotion`: 프로모션 정책 관리
- `PrimitivePromotionInfo`: 프로모션의 기본 정보(이름, 구매수량, 증정수량, 시작일, 종료일) 저장
- `Promotions`: 프로모션 목록 관리
- `Order`: 주문 정보와 할인 계산 처리
- `OrderItem`: 주문 항목(상품명, 수량) 저장
- `OrderLineItem`: 주문 항목의 상세 정보 및 할인 계산
- `Stock`: 전체 상품 재고 관리
- `Membership`: 멤버십 할인 정책 관리

### 유틸리티

- `IoHandler`: 입출력 작업 총괄 관리 싱글톤
- `InputHandler`: Console 입력 담당 싱글톤
- `OutputHandler`: 결과 출력 담당 싱글톤
- `ResourceHandler`: 파일 리소스 읽기 담당 싱글톤
- `InputValidatingParser`: 입력값 파싱/검증 담당 싱글톤
- `FileValidatingParser`: 파일 내용 파싱/검증 인터페이스
- `ProductFileValidatingParser`: 상품 파일 파싱/검증 담당 싱글톤
- `PromotionFileValidatingParser`: 프로모션 파일 파싱/검증 담당 싱글톤

### 열거형(Enum)

- `InputValidationMessage`: 입력값 검증 관련 에러 메시지
- `FileValidationMessage`: 파일 검증 관련 에러 메시지
- `ProductValidateMessage`: 상품 검증 관련 에러 메시지
- `PromotionValidateMessage`: 프로모션 검증 관련 에러 메시지
- `StockValidateMessage`: 재고 검증 관련 에러 메시지

## 기능 목록

### 입력 기능

- [x] 사용자가 적절한 값을 입력할때까지 Console.readLine()을 사용해 구매할 상품과 수량을 입력받는다.
- [x] 사용자가 적절한 값을 입력할때까지 Console.readLine()을 사용해 프로모션 적용 여부를 입력받는다.
- [x] 사용자가 적절한 값을 입력할때까지 Console.readLine()을 사용해 프로모션 적용이 불가할때 정가 적용 여부를 입력받는다.
- [x] 사용자가 적절한 값을 입력할때까지 Console.readLine()을 사용해 맴버십 할인 적용 여부를 입력받는다.
- [x] 사용자가 적절한 값을 입력할때까지 Console.readLine()을 사용해 추가 구매 여부를 입력받는다.

### 사용자 입력 검증 및 변환 기능

- [x] 구매 상품의 이름과 수량이 "[]"(대괄호)로 묶여있는지 검증한다.
- [x] 구매 상품의 이름과 수량이 '-'(하이픈)으로 나눌수 있는지 검증한다.
- [x] 구매 상품의 목록을 ','(콤마)로 나눌수 있는지 검증한다.
- [x] 구매 상품의 이름이 판매하고 있는 상품에 부합하는지 검증한다.
- [x] 구매 상품의 수량이 양의 숫자인지 검증한다.
- [x] 구매 상품의 수량이 최대 범위를 넘어서는지 검증한다.
- [x] 구매 상품의 수량이 최소 수량(1) 이상인지 검증한다.
- [x] 동일한 상품이 중복되어 입력되었는지 검증한다.
- [x] 프로모션 적용 여부가 'Y', 'N'인지 검증한다.
- [x] 프로모션 적용이 불가할때 정가 적용 여부가 'Y', 'N'인지 검증한다.
- [x] 맴버십 할인 적용 여부가 'Y', 'N'인지 검증한다.
- [x] 추가 구매 여부가 'Y', 'N'인지 검증한다.

### 출력 기능

- [x] 환영인사와 상품명, 가격, 프로모션 이름, 재고가 있다면 재고를, 없다면 재고없음을 출력한다.
- [x] 프로모션 적용 여부 안내 메시지를 출력한다.
- [x] 프로모션 적용이 불가할때 정가 적용 여부를 상품명, 수량을 포함한 안내 메시지를 출력한다.
- [x] 맴버십 할인 적용 안내 메시지를 출력한다.
- [x] 구매 상품 내역, 증정 상품 내역, 금액 정보를 출력한다.
- [x] 추가 구매 여부 안내 메시지를 출력한다.
- [x] 사용자의 입력이 잘못되었을때 에러 안내 메시지를 출력한다.
- [x] 주문 객체를 받아 구매 상품 내역, 증정 상품 내역, 금액 정보를 출력한다.

### 편의점 매니저 기능

- [x] 편의점 기능 전체를 총괄한다.

### 파일을 읽는 기능

- [x] 상품 파일을 읽어 상품 목록을 반환한다.
- [x] 프로모션 파일을 읽어 프로모션 목록을 반환한다.

### 상품 파일 내용 검증 및 변환 기능

- [x] 상품의 첫번째 줄을 ','(콤마)로 나눈 길이와 열의 길이가 같은지 검증한다.
- [x] 상품을 ','(콤마)로 나눈 길이와 열의 길이가 같은지 검증한다.
- [x] 상품의 가격이 양의 숫자인지 검증한다.
- [x] 상품의 가격이 최대 범위를 넘어서는지 검증한다.
- [x] 상품의 가격이 0보다 큰지 검증한다.
- [x] 상품의 수량이 양의 숫자인지 검증한다.
- [x] 상품의 수량이 최대 범위를 넘어서는지 검증한다.
- [x] 상품의 수량이 0과 같거나 큰지 검증한다.

### 프로모션 파일 내용 검증 및 변환 기능

- [x] 프로모션의 첫번째 줄을 ','(콤마)로 나눈 길이와 열의 길이가 같은지 검증한다.
- [x] 프로모션을 ','(콤마)로 나눈 길이와 열의 길이가 같은지 검증한다.
- [x] 프로모션 제공 기준 수량이 양의 숫자인지 검증한다.
- [x] 프로모션 제공 기준 수량이 최대 범위를 넘어서는지 검증한다
- [x] 프로모션 제공 수량이 양의 숫자인지 검증한다.
- [x] 프로모션 제공 수량이 최대 범위를 넘어서는지 검증한다
- [x] 프로모션 시작 날짜와 종료 날짜의 형식이 유효한지 검증한다.
- [x] 프로모션 시작 날짜가 종료 날짜 이전인지 검증한다.

### 상품 기능

- [x] 상품의 이름, 가격, 프로모션을 받아 상품을 생성한다.
- [x] 원시 상품과 프로모션을 받아 상품을 생성한다.
- [x] 감소할 수량을 받아 수량을 감소시킨다.
- [x] 상품이 프로모션을 가지고 있는지 반환한다.
- [x] 상품의 이름이 비어있는지 검증한다.
- [x] 상품의 가격이 0 보다 큰지 검증한다.
- [x] 상픔의 수량이 0 보다 작은지 검증한다.

### 재고 관리 기능

- [x] 상품 목록을 받아 재고를 생성한다.
- [x] 중복된 상품이 있는지 검증한다.
- [x] 하나의 상품에 두개 이상의 프로모션이 있는지 검증한다.
- [x] 각 상품의 재고를 고려하여 주문 가능 여부를 확인한다.
- [x] 프로모션이 적용된 상품이고 프로모션이 유효한지 확인한다.
- [x] 주문한 수량에 따른 프로모션 주문 상태를 반환한다.
- [x] 일반 상품 정보를 반환한다.
- [x] 주문 후 재고를 차감한다.

### 프로모션 기능

- [x] 프로모션의 이름, 구매수량, 증정수량, 시작날짜, 종료날짜를 입력받아 프로모션을 생성한다.
- [x] 원시 프로모션을 받아 프로모션을 생성한다.
- [x] 프로모션의 이름이 비어있는지 검증한다.
- [x] 프로모션의 구매수량과 증정수량이 0보다 큰지 검증한다.
- [x] 프로모션의 구매수량이 증정수량보다 작은지 검증한다.
- [x] 프로모션의 시작날짜와 종료날짜가 비어있는지 검증한다.
- [x] 프로모션의 시작날짜가 종료날짜 이전인지 검증한다.

### 프로모션 목록 관리 기능

- [x] 프로모션 목록을 받아 생성한다.
- [x] 상품의 프로모션 이름을 받아 해당 프로모션을 반환한다.

### 멤버십 기능

- [x] 예상 구매 목록을 받아 예상 멤버십 할인 금액을 계산한다.
- [x] 예상 멤버십 할인 금액이 한도를 초과하는지 확인한다.

### 주문 기능

- [x] 주문 항목 목록, 맴버십, 맴버십 적용여부를 받아 주문을 생성한다.
- [x] 주문 항목 목록을 반환한다.
- [x] 프로모션 적용 주문 항목을 반환한다.
- [x] 주문 총 구매액을 반환한다.
- [x] 프로모션 할인 금액을 반환한다.
- [x] 맴버십 할인 금액을 반환한다.
- [x] 사용자가 지불할 금액을 반환한다.
- [x] 총 주문 개수를 반환한다.

## 테스트 목록

### 사용자 입력 검증 및 변환 테스트

- [x] 구매 상품 목록을 받아 상품 목록을 성공적으로 생성한다.
- [x] 구매 상품의 이름과 수량이 "[]"(대괄호)로 묶여있지 않다면 예외가 발생한다.
- [x] 구매 상품의 이름과 수량이 '-'(하이픈)으로 나눌수 없다면 예외가 발생한다.
- [x] 구매 상품의 목록을 ','(콤마)로 나눌수 있는지 없다면 예외가 발생한다.
- [x] 구매 상품의 이름이 판매하고 있는 상품에 부합하지 않으면 예외가 발생한다.
- [x] 구매 상품의 수량이 양의 숫자가 아니면 예외가 발생한다.
- [x] 구매 상품의 수량이 최소 수량보다 작으면 예외가 발생한다.
- [x] 구매 상품의 수량이 최대 범위를 넘어선다면 예외가 발생한다.
- [x] 동일한 상품이 중복되어 입력되면 예외가 발생한다.
- [x] 추가 주문 답변이 'Y' 또는 'N'이면 성공적으로 반환한다.
- [x] 추가 주문 답변이 'Y' 또는 'N'이 아니면 예외가 발생한다.

### 파일 읽기 테스트

- [x] 상품 파일을 읽어 원시 상품 목록을 반환한다.
- [x] 상품 파일이 없다면 예외가 발생한다.
- [x] 빈 상품 파일이라면 예외가 발생한다.
- [x] 프로모션 파일을 읽어 원시 프로모션 목록을 반환한다.
- [x] 프로모션 파일이 없다면 예외가 발생한다.
- [x] 빈 프로모션 파일이라면 예외가 발생한다.

### 상품 파일 내용 검증 및 변환 테스트

- [x] 상품 파일 내용을 읽어 원시 상품 목록을 반환한다.
- [x] 상품의 첫번째 줄을 ','(콤마)로 나눈 길이와 열의 길이가 같지 않으면 예외가 발생한다.
- [x] 상품을 ','(콤마)로 나눈 길이와 열의 길이가 같지 않으면 예외가 발생한다.
- [x] 상품의 가격이 숫자가 아니면 예외가 발생한다.
- [x] 상품의 가격이 최대 범위를 넘어서면 예외가 발생한다.
- [x] 상품의 가격이 0과 같거나 작으면 예외가 발생한다.
- [x] 상품의 수량이 숫자가 아니면 예외가 발생한다.
- [x] 상품의 수량이 최대 범위를 넘어서면 예외가 발생한다.
- [x] 상품의 수량이 0보다 작으면 예외가 발생한다.

### 프로모션 파일 내용 검증 및 변환 테스트

- [x] 프로모션 파일 내용을 읽어 원시 프로모션 목록을 반환한다.
- [x] 프로모션의 첫번째 줄을 ','(콤마)로 나눈 길이와 열의 길이가 같지 않으면 예외가 발생한다.
- [x] 프로모션을 ','(콤마)로 나눈 길이와 열의 길이가 같지 않으면 예외가 발생한다.
- [x] 프로모션 제공 기준 수량이 숫자가 아니면 예외가 발생한다.
- [x] 프로모션 제공 기준 수량이 최대 범위를 넘어서면 예외가 발생한다.
- [x] 프로모션 제공 수량이 숫자가 아니면 예외가 발생한다.
- [x] 프로모션 제공 수량이 최대 범위를 넘어서면 예외가 발생한다.
- [x] 프로모션 시작 날짜의 형식이 유효하지 않으면 예외가 발생한다.
- [x] 프로모션 종료 날짜의 형식이 유효하지 않으면 예외가 발생한다.
- [x] 프로모션 시작 날짜가 종료 날짜가 이후이면 예외가 발생한다.

### 상품 테스트

- [x] 상품의 이름, 가격, 프로모션을 받아 상품을 성공적으로 생성한다.
- [x] 원시 상품과 프로모션을 받아 상품을 생성한다.
- [x] 상품이 프로모션을 가지고 있는지 반환한다.
- [x] 상품의 이름이 비어있다면 예외가 발생한다.
- [x] 상품의 가격이 0 보다 크지 않다면 예외가 발생한다.
- [x] 상픔의 수량이 0 보다 작다면 예외가 발생한다.

### 재고 관리 테스트

- [x] 중복된 상품이 있다면 예외가 발생한다.
- [x] 하나의 상품에 두개 이상의 프로모션이 있다면 예외가 발생한다.
- [x] 프로모션이 없는 상품의 품절 버전을 추가한다.
- [x] 각 상품의 재고를 고려하여 주문 가능 여부를 확인한다.
- [x] 프로모션이 적용된 상품이고 유효한 프로모션인지 확인한다.
- [x] 주문한 수량에 따른 프로모션 주문 상태를 반환한다.
    - [x] 재고가 부족한 경우 INSUFFICIENT_STOCK을 반환한다.
    - [x] 프로모션 적용 가능한 수량보다 적은 경우 BELOW_QUANTITY를 반환한다.
    - [x] 프로모션 적용 가능한 정확한 수량인 경우 EXACT_QUANTITY를 반환한다.
- [x] 일반 상품 정보를 반환한다.
- [x] 주문 후 재고를 차감한다.
    - [x] 프로모션 적용 상품의 재고를 차감한다.
    - [x] 일반 상품의 재고를 차감한다.

### 프로모션 테스트

- [x] 프로모션의 이름, 구매수량, 증정수량, 시작날짜, 종료날짜를 입력받아 성공적으로 프로모션을 생성한다.
- [x] 원시 프로모션을 받아 성공적으로 프로모션을 생성한다.
- [x] 프로모션의 이름이 비어있다면 예외가 발생한다.
- [x] 프로모션의 구매수량과 증정수량이 0보다 크지 않다면 예외가 발생한다.
- [x] 프로모션의 구매수량이 증정수량보다 작다면 예외가 발생한다.
- [x] 프로모션의 시작날짜와 종료날짜의 형식이 맞지않으면 예외가 발생한다.
- [x] 프로모션의 시작날짜와 종료날짜가 비어있다면 예외가 발생한다.
- [x] 프로모션의 시작날짜가 종료날짜 이전이라면 예외가 발생한다.
- [x] 프로모션 재고를 고려하여 적용 가능 여부를 확인한다.
- [x] 구매 수량과 프로모션 적용 수량을 비교하여 구매 수량을 추가할지 확인한다.
- [x] 구매 수량과 프로모션 적용 수량을 비교하여 프로모션 재고가 부족하면 일반 재고를 사용할지 확인한다.

### 프로모션 목록 관리 테스트

- [x] 원시 프로모션 목록을 받아 프로모션 목록을 성공적으로 생성한다.
- [x] 상품의 프로모션 이름을 받아 해당 프로모션을 반환한다.
- [x] 상품의 프로모션 이름에 해당되는것이 없다면 null을 반환한다.

### 멤버십 테스트

- [x] 프로모션 미적용 금액을 받아 예상 멤버십 할인 금액을 계산한다.
- [x] 예상 멤버십 할인 금액이 한도를 초과한다면 최대 할인 금액으로 적용한다.

### 주문 테스트

- [x] 주문 항목 목록, 맴버십, 맴버십 적용여부를 받아 주문을 생성한다.
- [x] 주문 항목 목록을 반환한다.
- [x] 프로모션 적용 주문 항목을 반환한다.
- [x] 주문 총 구매액을 반환한다.
- [x] 프로모션 할인 금액을 반환한다.
- [x] 맴버십 할인 금액을 반환한다.
- [x] 사용자가 지불할 금액을 반환한다.
- [x] 총 주문 개수를 반환한다.

## 작성자

lvalentine6 (이승로)
